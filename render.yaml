services:
  # -----------------------------
  # Backend Service (FastAPI)
  # -----------------------------
  - type: web
    name: supoclip-backend-production
    env: docker
    dockerContext: .
    dockerfilePath: ./Dockerfile
    plan: free
    region: oregon
    numInstances: 1
    healthCheckPath: /health/db
    envVars:
      - key: PYTHONUNBUFFERED
        value: 1
      
      # ---- APP SETTINGS ----
      - key: LLM
        value: openai:gpt-4
      - key: WHISPER_MODEL_SIZE
        value: base
      - key: TEMP_DIR
        value: /tmp/uploads


  # -----------------------------
  # Worker Service (ARQ Worker)
  # -----------------------------
  - type: worker
    name: supoclip-worker-production
    env: docker
    dockerContext: .
    dockerfilePath: ./Dockerfile
    dockerCommand: "arq src.workers.tasks.WorkerSettings"
    plan: free
    region: oregon
    numInstances: 1
    envVars:
      - key: PYTHONUNBUFFERED
        value: 1
      - key: WHISPER_MODEL_SIZE
        value: base
      - key: TEMP_DIR
        value: /tmp/uploads

# ---------------------------------------------------
# ðŸš¨ Removed:
# - Frontend (Deploying to Vercel)
# - Built-in Render PostgreSQL
# - Render Redis
# ---------------------------------------------------
